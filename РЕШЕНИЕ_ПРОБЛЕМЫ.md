# ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!

## üéØ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞:
–í—ã –ø–æ–ª—É—á–∞–ª–∏ –æ—à–∏–±–∫—É `{"error":"Method not allowed","message":"Only POST requests are allowed"}` –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

### –ü—Ä–∏—á–∏–Ω–∞:
–§—É–Ω–∫—Ü–∏—è `create-payment-intent` –ø—Ä–∏–Ω–∏–º–∞–ª–∞ —Ç–æ–ª—å–∫–æ POST –∑–∞–ø—Ä–æ—Å—ã, –∞ –±—Ä–∞—É–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ URL.

### –†–µ—à–µ–Ω–∏–µ:
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ GET –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏!**

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã—Ç—å URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ —É–≤–∏–¥–µ—Ç—å:
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –∫–ª—é—á Stripe
- –ö–∞–∫–æ–π —Ç–∏–ø –∫–ª—é—á–∞ (TEST/LIVE)
- –ü–µ—Ä–≤—ã–µ 15 —Å–∏–º–≤–æ–ª–æ–≤ –∫–ª—é—á–∞
- –í–µ—Ä—Å–∏—é Node.js
- –ö–æ–Ω—Ç–µ–∫—Å—Ç Netlify
- –ü—Ä–∏–º–µ—Ä curl –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üöÄ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–π—á–∞—Å!

### 1Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/create-payment-intent
```

### 2Ô∏è‚É£ –ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

#### ‚úÖ –ï—Å–ª–∏ –∫–ª—é—á —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
```json
{
  "message": "Payment Intent API - Ready",
  "configuration": {
    "hasStripeKey": true,
    "keyType": "TEST",
    "keyPrefix": "sk_test_51xxxxx",
    "nodeVersion": "v18.x.x",
    "netlifyContext": "production"
  },
  "testWithCurl": "curl -X POST ..."
}
```
**‚Üí –í—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å!** üéâ

#### ‚ùå –ï—Å–ª–∏ –∫–ª—é—á –ù–ï —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```json
{
  "configuration": {
    "hasStripeKey": false,
    "keyType": "MISSING",
    "keyPrefix": "NOT_SET"
  }
}
```
**‚Üí –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á** (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∏–∂–µ) üëá

---

## üîß –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á

### –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ Netlify UI):

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** https://app.netlify.com ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ:** Site Configuration ‚Üí Environment Variables
3. **–ù–∞–∂–º–∏—Ç–µ:** Add a variable
4. **–î–æ–±–∞–≤—å—Ç–µ:**
   ```
   Key: STRIPE_SECRET_KEY
   Value: sk_test_–≤–∞—à_–∫–ª—é—á_–∏–∑_stripe
   Scopes: ‚úÖ Production ‚úÖ Deploy Previews ‚úÖ Branch Deploys
   ```
5. **–î–µ–ø–ª–æ–π:** Deploys ‚Üí Trigger deploy ‚Üí Clear cache and deploy site
6. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ** 1-2 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ —Å–æ–±–µ—Ä—ë—Ç—Å—è
7. **–û–±–Ω–æ–≤–∏—Ç–µ** —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π

### –ì–¥–µ –≤–∑—è—Ç—å –∫–ª—é—á:
1. https://dashboard.stripe.com/
2. Developers ‚Üí API keys
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Secret key** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk_test_...`)

---

## üì¶ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `netlify/functions/create-payment-intent.js` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ GET –∑–∞–ø—Ä–æ—Å–æ–≤
2. ‚úÖ `package.json` - –¥–æ–±–∞–≤–ª–µ–Ω—ã npm —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Netlify

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è):
1. üìò `STRIPE_QUICK_TEST.md` - –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ 30 —Å–µ–∫—É–Ω–¥
2. üìó `TEST_PAYMENT_FUNCTION.md` - –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
3. üìï `QUICK_FIX_STRIPE.md` - –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
4. üìô `NETLIFY_ENV_DEBUG.md` - –≥–ª—É–±–æ–∫–∞—è –æ—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º
5. üìì `README_STRIPE_DEBUG.md` - –∫—Ä–∞—Ç–∫–∞—è –ø–∞–º—è—Ç–∫–∞
6. üõ†Ô∏è `check-netlify-env.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ CLI
7. üß™ `netlify/functions/test-env.js` - —Ç–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (—É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ –æ—Ç–ª–∞–¥–∫–∏)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/create-payment-intent
```

### –®–∞–≥ 2: –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - –¥–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á
–°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤—ã—à–µ ‚òùÔ∏è

### –®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É curl –∏–∑ GET –æ—Ç–≤–µ—Ç–∞, –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
curl -X POST https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/create-payment-intent \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "planName": "Test Plan"}'
```

–î–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å:
```json
{
  "clientSecret": "pi_xxx_secret_yyy"
}
```

### –®–∞–≥ 4: –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```bash
git add .
git commit -m "Add Stripe debugging and GET support for payment function"
git push
```

### –®–∞–≥ 5: –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏
–£–¥–∞–ª–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é:
```bash
rm netlify/functions/test-env.js
git add netlify/functions/test-env.js
git commit -m "Remove test env function"
git push
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
./check-netlify-env.sh

# –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å Netlify Dev
npm run netlify:dev

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl
curl https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/create-payment-intent

# –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç—ë–∂
curl -X POST https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/create-payment-intent \
  -H "Content-Type: application/json" \
  -d '{"amount": 10, "planName": "Test"}'
```

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Netlify:**
   - Functions ‚Üí create-payment-intent ‚Üí Recent logs
   - –ò—â–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `üîë Environment check:`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é:**
   ```
   https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/test-env
   ```

3. **–ß–∏—Ç–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: `STRIPE_QUICK_TEST.md`
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `TEST_PAYMENT_FUNCTION.md`
   - –û—Ç–ª–∞–¥–∫–∞: `NETLIFY_ENV_DEBUG.md`

---

## ‚ú® –¢–µ–ø–µ—Ä—å –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!

–í–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏ `"Method not allowed"` –≤—ã –≤–∏–¥–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏! üéâ

**–ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π—Ç–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ!** üöÄ

---

*–°–æ–∑–¥–∞–Ω–æ: 16 –æ–∫—Ç—è–±—Ä—è 2025*

