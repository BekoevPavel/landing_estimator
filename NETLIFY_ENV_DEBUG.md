# –û—Ç–ª–∞–¥–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Stripe –Ω–∞ Netlify

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Netlify UI

1. –ó–∞–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –Ω–∞ Netlify
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Site Configuration** ‚Üí **Environment Variables**
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   - `STRIPE_SECRET_KEY` - –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `sk_test_` –∏–ª–∏ `sk_live_`)
   - `VITE_STRIPE_PUBLISHABLE_KEY` - –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `pk_test_` –∏–ª–∏ `pk_live_`)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–í Netlify –µ—Å—Ç—å —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
- **Production** - —Ç–æ–ª—å–∫–æ –¥–ª—è production –¥–µ–ø–ª–æ—è
- **Deploy previews** - –¥–ª—è preview –¥–µ–ø–ª–æ–µ–≤
- **Branch deploys** - –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫

**–í–∞–∂–Ω–æ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –Ω—É–∂–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π!

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∫–ª—é—á–µ–π Stripe:
```
STRIPE_SECRET_KEY=sk_test_51Abc...xyz
VITE_STRIPE_PUBLISHABLE_KEY=pk_test_51Abc...xyz
```

**–û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å:**
- ‚ùå –ü—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚ùå –ö–∞–≤—ã—á–∫–∏ –≤–æ–∫—Ä—É–≥ –∑–Ω–∞—á–µ–Ω–∏—è (Netlify –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∫–∞–≤—ã—á–µ–∫)
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–µ—Ñ–∏–∫—Å –∫–ª—é—á–∞

### –®–∞–≥ 4: –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ù–ï –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —Å—Ç–∞—Ä—ã–º –¥–µ–ø–ª–æ—è–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. –ù—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π: **Deploys** ‚Üí **Trigger deploy** ‚Üí **Clear cache and deploy site**

## üêõ –û—Ç–ª–∞–¥–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏:

1. –ó–∞–π–¥–∏—Ç–µ –≤ **Functions** –≤ Netlify UI
2. –ù–∞–π–¥–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `create-payment-intent`
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–∑–æ–≤—ã –∏ –∏—Ö –ª–æ–≥–∏

–í –ª–æ–≥–∞—Ö –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤—ã–≤–æ–¥ –æ—Ç —Å—Ç—Ä–æ–∫ 66-71:
```javascript
console.log("üîë Environment check:", {
  hasStripeKey: !!process.env.STRIPE_SECRET_KEY,
  keyPrefix: process.env.STRIPE_SECRET_KEY ? process.env.STRIPE_SECRET_KEY.substring(0, 15) : "NOT_SET",
  allEnvKeys: Object.keys(process.env).filter(k => k.includes('STRIPE'))
});
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
üîë Environment check: {
  hasStripeKey: true,
  keyPrefix: "sk_test_51Abc",
  allEnvKeys: ["STRIPE_SECRET_KEY"]
}
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ:
```
üîë Environment check: {
  hasStripeKey: false,
  keyPrefix: "NOT_SET",
  allEnvKeys: []
}
```
–ó–Ω–∞—á–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞.

## üîß –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Netlify CLI

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Netlify CLI
npm install -g netlify-cli

# –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å
netlify login

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /Users/pavelbekoev/landing_estimator

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
netlify env:list

# –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö:
netlify env:set STRIPE_SECRET_KEY "sk_test_–≤–∞—à_–∫–ª—é—á"
netlify env:set VITE_STRIPE_PUBLISHABLE_KEY "pk_test_–≤–∞—à_–∫–ª—é—á"
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

–°–æ–∑–¥–∞–π—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```javascript
// netlify/functions/test-env.js
exports.handler = async () => {
  return {
    statusCode: 200,
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      hasStripeSecret: !!process.env.STRIPE_SECRET_KEY,
      stripeKeyPrefix: process.env.STRIPE_SECRET_KEY 
        ? process.env.STRIPE_SECRET_KEY.substring(0, 15) 
        : "NOT_SET",
      allStripeKeys: Object.keys(process.env).filter(k => k.includes('STRIPE')),
      nodeVersion: process.version,
    }),
  };
};
```

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–∑–æ–≤–∏—Ç–µ: `https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/.netlify/functions/test-env`

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Netlify UI (Site Configuration ‚Üí Environment Variables)
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Production/Deploy previews)
- [ ] –ö–ª—é—á–∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (sk_test_ –∏–ª–∏ sk_live_)
- [ ] –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –∏–ª–∏ –∫–∞–≤—ã—á–µ–∫ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö
- [ ] –ó–∞–ø—É—â–µ–Ω –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Netlify UI
- [ ] package.json —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å "stripe" (–¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π)

## üì¶ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ package.json –µ—Å—Ç—å:
```json
{
  "dependencies": {
    "stripe": "^14.0.0" // –∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –≤–µ—Ä—Å–∏—è
  }
}
```

–ï—Å–ª–∏ –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ:
```bash
npm install stripe
git add package.json package-lock.json
git commit -m "Add stripe dependency"
git push
```

## üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

1. **–û—à–∏–±–∫–∞**: "Stripe is not a constructor"
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω npm –ø–∞–∫–µ—Ç `stripe`
   - **–†–µ—à–µ–Ω–∏–µ**: `npm install stripe`

2. **–û—à–∏–±–∫–∞**: "STRIPE_SECRET_KEY not configured"
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
   - **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ —á–µ—Ä–µ–∑ Netlify UI –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ

3. **–û—à–∏–±–∫–∞**: "Invalid API Key provided"
   - **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω publishable key –≤–º–µ—Å—Ç–æ secret
   - **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `sk_`

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–ê–ñ–ù–û**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ git!
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`
- ‚ùå –ù–µ —Ö–∞—Ä–¥–∫–æ–¥—å—Ç–µ –∫–ª—é—á–∏ –≤ –∫–æ–¥–µ
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ secret key –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

---

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à–∏ –∫–ª—é—á–∏ Stripe –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ Netlify! üéâ

